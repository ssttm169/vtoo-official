"use strict";(self.webpackChunkvtoo_official=self.webpackChunkvtoo_official||[]).push([[586],{5400:(e,t,a)=>{a.r(t),a.d(t,{default:()=>p});var s=a(758),n=a(7041),o=a(6997),l=a(2829),i=a.n(l),r=(a(7759),a(384)),c=a(8026),m=a(6423),d=(a(1797),a(6070));const u=e=>{let{children:t}=e;const{siteConfig:a}=(0,m.A)(),[n,o]=(0,s.useState)(""),l=a.customFields.apiBaseUrl,i=r.A.canUseDOM?`${l}/api`:"";return(0,s.useEffect)((()=>{(async()=>{try{const e=await fetch(`${i}/csrf-token`,{method:"GET",credentials:"include"});if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();o(t.csrfToken)}catch(e){console.error("Error fetching CSRF token:",e)}})()}),[]),(0,s.useEffect)((()=>{if(n){const e=window.fetch;return window.fetch=function(t,a){return void 0===a&&(a={}),a.headers=a.headers||{},a.headers["X-CSRF-Token"]=n,e(t,a)},()=>{window.fetch=e}}}),[n]),(0,d.jsx)(d.Fragment,{children:t})},h=e=>{let{isOpen:t,onClose:a,children:s}=e;return t?(0,d.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:(0,d.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full",children:[s,(0,d.jsx)("div",{className:"text-right",children:(0,d.jsx)("button",{style:{border:"none"},onClick:a,className:"submit-btn mt-4  bg-[#663399] text-white font-bold py-2.5 px-4 rounded ",children:"Close"})})]})}):null},p=()=>{const{siteConfig:e}=(0,m.A)(),t=e.customFields.apiBaseUrl,a=e.customFields.apiToken,[l,p]=(0,s.useState)(null),[x,f]=(0,s.useState)(null),[b,j]=(0,s.useState)(!1),g=r.A.canUseDOM?`${t}/api`:"",w=["image/jpeg","image/png"],y=o.Ik().shape({full_name:o.Yj().required("Please Enter Your Name"),email:o.Yj().email("Incorrect mailbox format").required("Please enter email"),subject:o.Yj().required("Please enter subject"),content:o.Yj().required("Please enter content"),captcha:o.Yj().required("Please enter captcha"),attachments:o.gl().nullable().test("fileFormat","Unsupported Format",(e=>!e||Array.from(e).every((e=>w.includes(e.type))))).test("fileSize","Max allowed size is 1MB",(e=>!e||Array.from(e).every((e=>e.size<=1048576)))).test("fileLimit","Max allowed 2 images",(e=>!e||Array.from(e).length<3))});let v="https://api.vtoo.app/api/captcha";const[N,k]=(0,s.useState)(v),[S,F]=(0,s.useState)(!0),C=()=>{F((e=>!e)),setTimeout((()=>{k(`${v}?t=${Date.now()}`),F((e=>!e))}))};return(0,d.jsx)(c.A,{title:"Support",description:"Description will go into a meta tag in <head />",children:(0,d.jsx)(u,{children:(0,d.jsxs)("div",{className:"custom-page",children:[(0,d.jsx)("div",{style:{padding:"10px"}}),(0,d.jsx)("div",{children:(0,d.jsxs)("main",{className:"custom-page-main p-4",children:[(0,d.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Support"}),(0,d.jsx)("p",{className:"text-gray-800",children:"If you have any questions when using vtoo or you have better suggestions, please submit the form to contact us, and we will contact you as soon as possible after receiving it!"}),(0,d.jsx)(n.l1,{initialValues:{full_name:"",email:"",subject:"",content:"",captcha:"",attachments:null},validationSchema:y,onSubmit:async(e,t)=>{let{setSubmitting:s,resetForm:n}=t;f(null);if(!await(async e=>{try{const t=await fetch(`${g}/captcha/verify`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Origin:"https://vtoo.app"},body:JSON.stringify({captcha:e})});if(!t.ok)throw new Error("\u9a8c\u8bc1\u7801\u9a8c\u8bc1\u5931\u8d25");return(await t.json()).valid}catch(t){return console.error("\u9a8c\u8bc1\u7801\u9a8c\u8bc1\u9519\u8bef:",t),!1}})(e.captcha))return f("\u9a8c\u8bc1\u7801\u4e0d\u6b63\u786e\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"),s(!1),void document.querySelector("#captchaImg").click();const o=Object.keys(e).reduce(((t,a)=>(t[a]=i().sanitize(e[a]),t)),{});console.log("sanitizedValues",o);let l=[];if(e.attachments){const t=await(async e=>{try{const t=new FormData;Array.from(e).forEach((e=>{t.append("files",e)}));const s=await fetch(`${g}/upload`,{method:"POST",credentials:"include",headers:{Authorization:`Bearer ${a}`,Origin:"https://vtoo.app"},body:t});if(!s.ok)throw new Error("\u4e0a\u4f20\u56fe\u7247\u5f02\u5e38");return await s.json()}catch(t){return console.error("\u4e0a\u4f20\u56fe\u7247\u5f02\u5e38",t),setFieldError("attachments","\u4e0a\u4f20\u56fe\u7247\u5f02\u5e382"),!1}})(e.attachments);l=t.map((e=>e.id))}try{o.attachments=l?.length?l:[];const e={data:o},t=await fetch(`${g}/supports`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,Origin:"https://vtoo.app"},body:JSON.stringify(e)});if(!t.ok)throw new Error("\u63d0\u4ea4\u5931\u8d25");await t.json();p("success"),n(),j(!0)}catch(r){console.error("\u63d0\u4ea4\u9519\u8bef:",r),p("error")}finally{s(!1)}},children:e=>{let{isSubmitting:t,setFieldValue:a}=e;return(0,d.jsxs)(n.lV,{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"full_name",className:"font-black block text-sm font-medium text-gray-700 mb-1",children:"Your Name:"}),(0,d.jsx)(n.D0,{type:"text",name:"full_name",className:" vtoo-input w-full px-3 text-base leading-10   rounded-md shadow-sm   "}),(0,d.jsx)(n.Kw,{name:"full_name",component:"div",className:"error-text text-sm mt-1"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"email",className:"font-black block text-sm font-medium text-gray-700 mb-1",children:"Email:"}),(0,d.jsx)(n.D0,{type:"email",name:"email",className:" vtoo-input w-full px-3  text-base leading-10  rounded-md shadow-sm   "}),(0,d.jsx)(n.Kw,{name:"email",component:"div",className:"error-text text-sm mt-1"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"subject",className:"font-black block text-sm font-medium text-gray-700 mb-1",children:"Subject:"}),(0,d.jsx)(n.D0,{type:"text",name:"subject",className:" vtoo-input w-full px-3  text-base leading-10  rounded-md shadow-sm   "}),(0,d.jsx)(n.Kw,{name:"subject",component:"div",className:"error-text text-sm mt-1"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"content",className:"font-black block text-sm font-medium text-gray-700 mb-1",children:"Content:"}),(0,d.jsx)(n.D0,{as:"textarea",name:"content",rows:"4",className:"vtoo-textarea w-full px-3  border text-base leading-10  rounded-md shadow-sm   "}),(0,d.jsx)(n.Kw,{name:"content",component:"div",className:"error-text text-sm mt-1"})]}),(0,d.jsxs)("div",{className:"grid-col",children:[(0,d.jsx)(n.D0,{type:"text",name:"captcha",style:{height:"44px"},className:" vtoo-input w-full px-3  text-base leading-10  rounded-md shadow-sm   "}),S&&(0,d.jsx)("img",{id:"captchaImg",className:"rounded-md  captchaCls",height:44,src:N,onClick:C}),(0,d.jsx)(n.Kw,{name:"captcha",component:"div",className:"error-text text-sm mt-1"}),x&&(0,d.jsx)("div",{className:"text-red-500 text-sm mt-1",children:x})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{htmlFor:"attachments",className:"font-black block text-sm font-medium text-gray-700 mb-1",children:"Upload Attachment:"}),(0,d.jsx)("input",{id:"attachments",name:"attachments",type:"file",multiple:!0,accept:"image/jpeg, image/png",onChange:e=>{a("attachments",e.currentTarget.files)},className:" vtoo-input w-full px-3 text-base leading-10 rounded-md shadow-sm"}),(0,d.jsx)(n.Kw,{name:"attachments",component:"div",className:"error-text text-sm mt-1"})]}),(0,d.jsx)("button",{type:"submit",disabled:t,style:{border:"none",height:"44px"},className:"submit-btn text-base leading-10 w-full bg-[#663399] text-white font-bold px-4 rounded-md focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"Submitting...":"Submit"}),"error"===l&&(0,d.jsx)("div",{className:"text-red-500 text-sm mt-2",children:"Submission failed, please try again later."})]})}}),(0,d.jsxs)(h,{isOpen:b,onClose:()=>j(!1),children:[(0,d.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Submit successfully"}),(0,d.jsx)("p",{children:"Your form has been submitted successfully. We will get back to you shortly."})]})]})})]})})})}}}]);